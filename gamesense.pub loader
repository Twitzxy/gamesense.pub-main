-- Roblox Services
local TweenService = game:GetService("TweenService")

-- UI Colors (Gamesense style)
local COLORS = {
    Background = Color3.fromRGB(0, 0, 0),
    Text = Color3.fromRGB(0, 255, 0),
    Accent = Color3.fromRGB(0, 255, 0),
    Card = Color3.fromRGB(20, 20, 20),
    Error = Color3.fromRGB(255, 0, 0),
    Border = Color3.fromRGB(50, 50, 50)
}

-- Gradient Colors for Top Bar Animation (Rainbow)
local gradientColors = {
    Color3.fromRGB(255, 0, 0),
    Color3.fromRGB(255, 165, 0),
    Color3.fromRGB(255, 255, 0),
    Color3.fromRGB(0, 255, 0),
    Color3.fromRGB(0, 0, 255),
    Color3.fromRGB(75, 0, 130),
    Color3.fromRGB(238, 130, 238)
}

-- Create Main GUI
local MainGui = Instance.new("ScreenGui")
MainGui.Name = "GameSenseMain"
MainGui.Parent = game.CoreGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 500, 0, 400)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
mainFrame.BackgroundColor3 = COLORS.Background
mainFrame.BorderColor3 = COLORS.Border
mainFrame.BorderSizePixel = 1
mainFrame.ClipsDescendants = true
mainFrame.Parent = MainGui

-- Title Bar
local mainTitleBar = Instance.new("Frame")
mainTitleBar.Name = "TitleBar"
mainTitleBar.Size = UDim2.new(1, 0, 0, 30)
mainTitleBar.BackgroundColor3 = COLORS.Card
mainTitleBar.BorderSizePixel = 0
mainTitleBar.ZIndex = 2
mainTitleBar.Parent = mainFrame

-- Title Text
local mainTitle = Instance.new("TextLabel")
mainTitle.Text = "GAMESENSE.PUB // CHEAT MENU"
mainTitle.Font = Enum.Font.Code
mainTitle.TextSize = 14
mainTitle.TextColor3 = COLORS.Accent
mainTitle.BackgroundTransparency = 1
mainTitle.Size = UDim2.new(1, -40, 1, 0)
mainTitle.Position = UDim2.new(0.5, 0, 0, 0)
mainTitle.AnchorPoint = Vector2.new(0.5, 0)
mainTitle.TextXAlignment = Enum.TextXAlignment.Center
mainTitle.ZIndex = 3
mainTitle.Parent = mainTitleBar

-- Close Button
local mainCloseButton = Instance.new("TextButton")
mainCloseButton.Text = "X"
mainCloseButton.Size = UDim2.new(0, 30, 0, 30)
mainCloseButton.Position = UDim2.new(1, -30, 0, 0)
mainCloseButton.BackgroundColor3 = COLORS.Card
mainCloseButton.TextColor3 = COLORS.Text
mainCloseButton.Font = Enum.Font.Code
mainCloseButton.TextSize = 14
mainCloseButton.ZIndex = 3
mainCloseButton.Parent = mainTitleBar

mainCloseButton.MouseButton1Click:Connect(function()
    MainGui:Destroy()
end)

-- Dragging for main frame
local dragStartPos
local frameStartPos

mainTitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragStartPos = input.Position
        frameStartPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragStartPos = nil
            end
        end)
    end
end)

mainTitleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragStartPos then
        local delta = input.Position - dragStartPos
        mainFrame.Position = UDim2.new(
            frameStartPos.X.Scale, 
            frameStartPos.X.Offset + delta.X,
            frameStartPos.Y.Scale,
            frameStartPos.Y.Offset + delta.Y
        )
    end
end)

-- RGB Top Bar with smooth gradient transition
local mainTopBar = Instance.new("Frame")
mainTopBar.Size = UDim2.new(1, 0, 0, 2)
mainTopBar.Position = UDim2.new(0, 0, 1, -2)
mainTopBar.BackgroundColor3 = gradientColors[1]
mainTopBar.BorderSizePixel = 0
mainTopBar.ZIndex = 3
mainTopBar.Parent = mainTitleBar

-- Coroutine for smooth continuous gradient cycling
coroutine.wrap(function()
    local colorCount = #gradientColors
    local t = 0
    local speed = 1 / 5 -- 5 seconds per full cycle

    while task.wait(0.03) and mainTopBar.Parent do
        t = t + speed * 0.03
        if t > 1 then t = 0 end

        local index1 = math.floor(t * colorCount) + 1
        local index2 = index1 % colorCount + 1
        local lerpT = (t * colorCount) % 1

        mainTopBar.BackgroundColor3 = gradientColors[index1]:Lerp(gradientColors[index2], lerpT)
    end
end)()

-- Sidebar for tabs
local sidebar = Instance.new("Frame")
sidebar.Name = "Sidebar"
sidebar.Size = UDim2.new(0, 100, 0, 368)
sidebar.Position = UDim2.new(0, 0, 0, 30)
sidebar.BackgroundColor3 = COLORS.Card
sidebar.BorderSizePixel = 0
sidebar.Parent = mainFrame

-- Separator line on sidebar edge
local separator = Instance.new("Frame")
separator.Size = UDim2.new(0, 1, 1, 0)
separator.Position = UDim2.new(0, 100, 0, 0)
separator.BackgroundColor3 = COLORS.Border
separator.BorderSizePixel = 0
separator.Parent = sidebar

-- Main content area
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Size = UDim2.new(0, 399, 0, 368)
contentFrame.Position = UDim2.new(0, 101, 0, 30)
contentFrame.BackgroundColor3 = COLORS.Background
contentFrame.BorderSizePixel = 0
contentFrame.Parent = mainFrame

-- Improved FadeFrame function that waits for all tweens to complete
local function FadeFrame(frame, fadeIn, duration)
    duration = duration or 0.25
    local goals = {}

    goals.BackgroundTransparency = fadeIn and 0 or 1

    local tweens = {}
    table.insert(tweens, TweenService:Create(frame, TweenInfo.new(duration), {BackgroundTransparency = goals.BackgroundTransparency}))

    for _, v in pairs(frame:GetChildren()) do
        if v:IsA("TextLabel") or v:IsA("TextButton") or v:IsA("ImageLabel") or v:IsA("Frame") then
            local props = {
                BackgroundTransparency = fadeIn and 0 or 1,
                TextTransparency = fadeIn and 0 or 1,
                ImageTransparency = fadeIn and 0 or 1
            }
            table.insert(tweens, TweenService:Create(v, TweenInfo.new(duration), props))
        end
    end

    local completedCount = 0
    local totalTweens = #tweens

    for _, tween in ipairs(tweens) do
        tween:Play()
        tween.Completed:Connect(function()
            completedCount = completedCount + 1
        end)
    end

    -- Wait until all tweens complete
    while completedCount < totalTweens do
        task.wait(0.01)
    end
end

-- Function to create tabs and their content containers
local tabs = {}
local currentTabName = nil

local function HideAllTabs()
    for _, tab in pairs(tabs) do
        tab.Content.Visible = false
    end
end

local function CreateTab(name, yPos)
    local tabButton = Instance.new("TextButton")
    tabButton.Name = name .. "Tab"
    tabButton.Text = name
    tabButton.Size = UDim2.new(1, 0, 0, 30)
    tabButton.Position = UDim2.new(0, 0, 0, yPos)
    tabButton.BackgroundColor3 = COLORS.Card
    tabButton.TextColor3 = COLORS.Text
    tabButton.Font = Enum.Font.Code
    tabButton.TextSize = 14
    tabButton.Parent = sidebar

    -- Content Frame for this tab
    local tabContent = Instance.new("Frame")
    tabContent.Name = name .. "Content"
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.Position = UDim2.new(0, 0, 0, 0)
    tabContent.BackgroundTransparency = 1
    tabContent.Visible = false
    tabContent.Parent = contentFrame

    tabs[name] = {
        Button = tabButton,
        Content = tabContent,
    }

    tabButton.MouseButton1Click:Connect(function()
        if currentTabName == name then return end -- Already selected

        if currentTabName and tabs[currentTabName] then
            local currentContent = tabs[currentTabName].Content
            FadeFrame(currentContent, false)
            currentContent.Visible = false
        end

        local newContent = tabContent
        newContent.Visible = true
        FadeFrame(newContent, true)

        currentTabName = name
    end)

    return tabButton, tabContent
end

-- Helper function: Create placeholder tab content with simple text
local function createPlaceholderTab(name, yPos, placeholderText)
    local tabButton, tabContent = CreateTab(name, yPos)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0, 30)
    label.Position = UDim2.new(0, 0, 0, 20)
    label.BackgroundTransparency = 1
    label.Text = placeholderText
    label.TextColor3 = COLORS.Text
    label.Font = Enum.Font.Code
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Center
    label.Parent = tabContent
    return tabButton, tabContent
end

-- Create tabs
local mainTabButton, mainContent = createPlaceholderTab("Main", 0, "Main tab content here")
local legitTabButton, legitContent = createPlaceholderTab("Legit", 30, "Legit tab content here")
local rageTabButton, rageContent = createPlaceholderTab("Rage", 60, "Rage tab content here")
local visualsTabButton, visualsContent = createPlaceholderTab("Visuals", 90, "Visuals tab content here")
local miscTabButton, miscContent = createPlaceholderTab("Misc", 120, "Misc tab content here")
local configTabButton, configContent = createPlaceholderTab("Config", 150, "Config tab content here")

-- Show Main tab by default
tabs["Main"].Content.Visible = true
currentTabName = "Main"

